
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Defining trait space &#8212; Aerobic Saftey Margins for Marine Ectotherms</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"PO2atm": "P_{\\\\mathrm{O}_2}^{atm}", "PO": "P_{\\\\mathrm{O}_2}", "O2": "\\\\mathrm{O}_2}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Defining the Aerobic Safety Margin" href="trait-space-obs-habitat-vol.html" />
    <link rel="prev" title="The Metabolic Index" href="metabolic-index-defining.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Aerobic Saftey Margins for Marine Ectotherms</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Metabolic Index Traits
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="metabolic-index-defining.html">
   The Metabolic Index
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Defining trait space
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="trait-space-obs-habitat-vol.html">
   Defining the Aerobic Safety Margin
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Earth System Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="data-assets-preprocessing.html">
   Overview
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="obs-woa2018.html">
     World Ocean Atlas Dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="compute-drift-corr-cesm-le.html">
     Compute and apply linear drift correction to CESM1-LE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="compute-pO2-cesm-le.html">
     Compute oxygen partial pressure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="compute-viable-traits.html">
     Viable traits
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="compute-aerobic-safety-margin.html">
     Compute the Aerobic Safety Margin
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Aerobic Safety Margin
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="aerobic-habitat-change.html">
   Changes in aerobic habitat
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/matt-long/aerobic-safety-margins/main?urlpath=lab/tree/notebooks/trait-space-joint-pdf.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://jupyterhub.hpc.ucar.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/matt-long/aerobic-safety-margins&urlpath=lab/tree/aerobic-safety-margins/notebooks/trait-space-joint-pdf.ipynb&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/matt-long/aerobic-safety-margins"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/trait-space-joint-pdf.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-traits-database">
   Load traits database
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#illustrating-trait-distributions">
   Illustrating trait distributions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-the-trait-space-for-analysis">
   Define the trait space for analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-trait-coordinates">
     Define trait-coordinates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generate-a-low-resolution-trait-space">
     Generate a low-resolution trait space
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generate-a-higher-resolution-version-of-trait-space">
     Generate a higher resolution version of trait space
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solve-for-maximum-metabolic-temperature">
   Solve for maximum metabolic temperature
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#write-out-cached-trait-space-data">
   Write out cached trait-space data
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Defining trait space</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-traits-database">
   Load traits database
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#illustrating-trait-distributions">
   Illustrating trait distributions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-the-trait-space-for-analysis">
   Define the trait space for analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-trait-coordinates">
     Define trait-coordinates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generate-a-low-resolution-trait-space">
     Generate a low-resolution trait space
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generate-a-higher-resolution-version-of-trait-space">
     Generate a higher resolution version of trait space
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solve-for-maximum-metabolic-temperature">
   Solve for maximum metabolic temperature
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#write-out-cached-trait-space-data">
   Write out cached trait-space data
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="defining-trait-space">
<h1>Defining trait space<a class="headerlink" href="#defining-trait-space" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">cmocean</span>
<span class="kn">import</span> <span class="nn">constants</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">metabolic</span> <span class="k">as</span> <span class="nn">mi</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">util</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/glade/work/mclong/miniconda3/envs/metabolic/lib/python3.7/site-packages/dask_jobqueue/core.py:20: FutureWarning: tmpfile is deprecated and will be removed in a future release. Please use dask.utils.tmpfile instead.
  from distributed.utils import tmpfile
</pre></div>
</div>
</div>
</div>
<section id="load-traits-database">
<h2>Load traits database<a class="headerlink" href="#load-traits-database" title="Permalink to this headline">#</a></h2>
<p>A subset of the trait data from <span id="id1">Deutsch <em>et al.</em> [<a class="reference internal" href="references.html#id2" title="Curtis Deutsch, Justin L. Penn, and Brad Seibel. Metabolic trait diversity shapes marine biogeography. Nature, 585(7826):557–562, 2020. doi:10.1038/s41586-020-2721-y.">2020</a>]</span>, including only the marine organisms for which temerature-dependent hypoxia metabolic traits have been determined.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">open_traits_df</span></code> function is defined in the <a class="reference external" href="https://github.com/matt-long/aerobic-safety-margins/blob/main/notebooks/metabolic.py">metabolic</a> module and  makes the trait data available via a <a class="reference external" href="https://pandas.pydata.org/">pandas</a> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">open_traits_df</span><span class="p">(</span><span class="n">add_ATmax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>Phylum</th>
      <th>alphaD_log10</th>
      <th>Emet</th>
      <th>Eo</th>
      <th>Ao</th>
      <th>Ac</th>
      <th>Phi_crit</th>
      <th>ATmax_active</th>
      <th>ATmax_resting</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Acanthephyra acutifrons</td>
      <td>Crustacea</td>
      <td>0.479565</td>
      <td>0.040200</td>
      <td>-0.027836</td>
      <td>0.264715</td>
      <td>0.131959</td>
      <td>2.006040</td>
      <td>34.537414</td>
      <td>40.329376</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Acanthephyra curtirostris</td>
      <td>Crustacea</td>
      <td>0.377714</td>
      <td>0.043938</td>
      <td>0.038027</td>
      <td>0.252578</td>
      <td>0.141861</td>
      <td>1.780456</td>
      <td>33.674001</td>
      <td>38.427845</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Acanthephyra purpurea</td>
      <td>Crustacea</td>
      <td>1.035748</td>
      <td>0.840722</td>
      <td>0.131972</td>
      <td>0.230068</td>
      <td>0.073638</td>
      <td>3.124330</td>
      <td>24.602842</td>
      <td>35.679438</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Acanthephyra smithi</td>
      <td>Crustacea</td>
      <td>1.082577</td>
      <td>0.313173</td>
      <td>-0.030067</td>
      <td>0.286307</td>
      <td>0.174423</td>
      <td>1.641453</td>
      <td>37.082006</td>
      <td>40.961148</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Acipenser brevirostrum</td>
      <td>Chordata</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.362569</td>
      <td>0.218524</td>
      <td>0.048415</td>
      <td>4.513525</td>
      <td>15.523251</td>
      <td>31.128123</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Styela plicata</td>
      <td>Tunicata</td>
      <td>0.433791</td>
      <td>0.346635</td>
      <td>-0.190998</td>
      <td>0.061336</td>
      <td>0.043505</td>
      <td>1.409863</td>
      <td>NaN</td>
      <td>29.776087</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Systellaspis debilis</td>
      <td>Crustacea</td>
      <td>0.779626</td>
      <td>0.418652</td>
      <td>0.226970</td>
      <td>0.219289</td>
      <td>0.096003</td>
      <td>2.284196</td>
      <td>26.170657</td>
      <td>33.458520</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Tarletonbeania crenularis</td>
      <td>Chordata</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.213307</td>
      <td>0.203696</td>
      <td>0.051780</td>
      <td>3.933876</td>
      <td>17.531769</td>
      <td>33.144691</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Tautogolabrus adspersus</td>
      <td>Chordata</td>
      <td>0.801974</td>
      <td>0.327012</td>
      <td>0.244520</td>
      <td>0.170886</td>
      <td>0.051204</td>
      <td>3.337395</td>
      <td>17.067168</td>
      <td>31.182050</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Zoarces viviparus</td>
      <td>Chordata</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.789434</td>
      <td>0.177870</td>
      <td>0.062111</td>
      <td>2.863717</td>
      <td>17.365397</td>
      <td>24.766571</td>
    </tr>
  </tbody>
</table>
<p>61 rows × 10 columns</p>
</div></div></div>
</div>
</section>
<section id="illustrating-trait-distributions">
<h2>Illustrating trait distributions<a class="headerlink" href="#illustrating-trait-distributions" title="Permalink to this headline">#</a></h2>
<p>Recall the definition of the <a class="reference internal" href="metabolic-index-defining.html"><span class="doc std std-doc">Metabolic Index</span></a>:</p>
<div class="math notranslate nohighlight">
\[
  \Phi = A_o \frac{P_{\mathrm{O}_2}}
  {\mathrm{exp}\left[
  \frac{-E_o}{k_B}\left(
  \frac{1}{T} - \frac{1}{T_{ref}}
  \right)
  \right]
  }
\]</div>
<p>Parameters relevant to defining trait space:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_o\)</span>: Temperature sensitivity of metabolic rates.</p></li>
<li><p><span class="math notranslate nohighlight">\(A_o\)</span>: Hypoxic tolerance for resting metabolism.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Phi_{crit}\)</span>: lowest value of Metabolic Index at which <em>active</em> metabolism can be sustained.</p></li>
</ul>
<p>Since active metabolism requires <span class="math notranslate nohighlight">\(\Phi &gt;= \Phi_{crit}\)</span>, we can directly compute values of the Metabolic Index relevant for active metabolic rates, defining a new parameter:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A_c\)</span>: Hypoxic tolerance for active metabolism (i.e., <span class="math notranslate nohighlight">\(A_o / \Phi_{crit}\)</span>)</p></li>
</ul>
<p>The hidden code below defines a function for plotting trait histograms.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_trait_hist</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">trait</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

    <span class="n">pdf</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">trait_pdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">trait</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">.</span><span class="n">beta</span>
    <span class="n">trait_median</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

    <span class="n">trait_values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">trait</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="k">if</span> <span class="n">trait</span> <span class="ow">in</span> <span class="n">pdf</span><span class="o">.</span><span class="n">normal_traits</span><span class="p">:</span>
        <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">trait_values</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log10_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">trait_values</span><span class="p">)</span>
        <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="n">trait_values</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">log10_values</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">log10_values</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">30</span><span class="p">),</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">,</span> <span class="n">pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">trait</span><span class="si">}</span><span class="s1"> distribution&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">trait</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">trait</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">trait_median</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;median (</span><span class="si">{</span><span class="n">trait_median</span><span class="si">:</span><span class="s1">0.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">trait_median</span><span class="p">,</span> <span class="n">beta</span>
</pre></div>
</div>
</div>
</div>
<p>The following plots illustrate trait distributions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Eo_med</span><span class="p">,</span> <span class="n">Eo_beta</span> <span class="o">=</span> <span class="n">plot_trait_hist</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Eo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/trait-space-joint-pdf_8_0.png" src="_images/trait-space-joint-pdf_8_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ao_med</span><span class="p">,</span> <span class="n">Ao_beta</span> <span class="o">=</span> <span class="n">plot_trait_hist</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Ao&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/trait-space-joint-pdf_9_0.png" src="_images/trait-space-joint-pdf_9_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ac_med</span><span class="p">,</span> <span class="n">Ac_beta</span> <span class="o">=</span> <span class="n">plot_trait_hist</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Ac&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/trait-space-joint-pdf_10_0.png" src="_images/trait-space-joint-pdf_10_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Phi_crit_med</span><span class="p">,</span> <span class="n">Phi_crit_beta</span> <span class="o">=</span> <span class="n">plot_trait_hist</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Phi_crit&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/trait-space-joint-pdf_11_0.png" src="_images/trait-space-joint-pdf_11_0.png" />
</div>
</div>
<p>These individual traits can be combined into a joint probability distribution defining a “metabolic trait space.” Here we illustrate an idealized version of this trait space, fitting a normal distribution to <span class="math notranslate nohighlight">\(E_o\)</span> and a lognormal distribution to <span class="math notranslate nohighlight">\(A_c = A_o/\Phi_{crit}\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">markerorder</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">]</span>

<span class="n">Phyla</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Phylum</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

<span class="n">Eo_fit</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">trait_pdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Eo&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">Ac_fit</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">trait_pdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Ac&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>

<span class="c1"># Eo_bins = np.linspace(-1.0, 2.0, 30)</span>
<span class="c1"># Ac_bins = np.logspace(-3, np.log10(df.Ac.max()), 50)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">Eo_fit</span><span class="o">.</span><span class="n">coord</span><span class="p">,</span> <span class="n">Ac_fit</span><span class="o">.</span><span class="n">coord</span><span class="p">)</span>
<span class="n">Z1</span><span class="p">,</span> <span class="n">Z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">Eo_fit</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">Ac_fit</span><span class="o">.</span><span class="n">pdf</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>  <span class="c1"># figsize=(6, 6))</span>

<span class="n">mx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Z1</span> <span class="o">*</span> <span class="n">Z2</span><span class="p">)</span>
<span class="n">cf</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span>
    <span class="n">Y</span><span class="p">,</span>
    <span class="n">Z1</span> <span class="o">*</span> <span class="n">Z2</span> <span class="o">/</span> <span class="n">mx</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">tempo</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">1.02</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">xlm</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
<span class="n">ylm</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">phylum</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Phyla</span><span class="p">):</span>
    <span class="n">ndx</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Phylum</span> <span class="o">==</span> <span class="n">phylum</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">df</span><span class="o">.</span><span class="n">Eo</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ndx</span><span class="p">],</span>
        <span class="n">df</span><span class="o">.</span><span class="n">Ac</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ndx</span><span class="p">],</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="n">markerorder</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
        <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">phylum</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">attrs_label</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Eo</span><span class="o">.</span><span class="n">attrs</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">attrs_label</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Ac</span><span class="o">.</span><span class="n">attrs</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlm</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylm</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;figures/misc/trait-space-idealized.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/trait-space-joint-pdf_13_0.png" src="_images/trait-space-joint-pdf_13_0.png" />
</div>
</div>
</section>
<section id="define-the-trait-space-for-analysis">
<h2>Define the trait space for analysis<a class="headerlink" href="#define-the-trait-space-for-analysis" title="Permalink to this headline">#</a></h2>
<p>Trait space can be thought of something like an integration kernel, which enables computing the net capacity of the ocean to support aerobic metabolism, inclusive of the trait density distribution for ecothermic organisms.</p>
<p>In the sequence of operations below, we build two versions of the idealized trait space distribution:</p>
<ul class="simple">
<li><p>a low resolution (in trait space) version enabling analysis with the Earth system model;</p></li>
<li><p>a high resolution version for more refined assessments of habitat and trait variability.</p></li>
</ul>
<section id="define-trait-coordinates">
<h3>Define trait-coordinates<a class="headerlink" href="#define-trait-coordinates" title="Permalink to this headline">#</a></h3>
<p>Hypoxic tolerance is quantified by either <span class="math notranslate nohighlight">\(A_o\)</span> (resting) or <span class="math notranslate nohighlight">\(A_c = {A_o}/{\Phi_{crit}}\)</span>. As illustrated above, both <span class="math notranslate nohighlight">\(A_o\)</span> and <span class="math notranslate nohighlight">\(A_c\)</span> are lognormally distributed. To harmonize these two coordinates of trait space, we first fit lognormal distributions to <span class="math notranslate nohighlight">\(A_c\)</span> and <span class="math notranslate nohighlight">\(A_c\)</span>; then we use the CDF and “percentage point function” to determine a common “percentile” coordinate for both distributions.</p>
<p>See also:
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.lognorm.html">scipy.stats.lognormal documentation</a></p>
<p>First, fit <span class="math notranslate nohighlight">\(A_c\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj_Ac_pdf</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">trait_pdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Ac&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">,</span> <span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Trait PDF: Ac&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">attrs_label</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Ac</span><span class="o">.</span><span class="n">attrs</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">,</span> <span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Trait CDF: Ac&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">attrs_label</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Ac</span><span class="o">.</span><span class="n">attrs</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Ac&#39;</span><span class="p">:</span> <span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;PDF&#39;</span><span class="p">:</span> <span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="s1">&#39;CDF&#39;</span><span class="p">:</span> <span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ac</th>
      <th>PDF</th>
      <th>CDF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0300</td>
      <td>3.926803</td>
      <td>0.012578</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0370</td>
      <td>8.427573</td>
      <td>0.056621</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0456</td>
      <td>11.385733</td>
      <td>0.143946</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0562</td>
      <td>11.869385</td>
      <td>0.269404</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0693</td>
      <td>10.377166</td>
      <td>0.416393</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0854</td>
      <td>7.939445</td>
      <td>0.563752</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.1053</td>
      <td>5.431292</td>
      <td>0.695479</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.1299</td>
      <td>3.365103</td>
      <td>0.801594</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.1601</td>
      <td>1.910592</td>
      <td>0.878990</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.1974</td>
      <td>0.995958</td>
      <td>0.931125</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.2433</td>
      <td>0.479354</td>
      <td>0.963356</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.3000</td>
      <td>0.212853</td>
      <td>0.981828</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/trait-space-joint-pdf_15_1.png" src="_images/trait-space-joint-pdf_15_1.png" />
</div>
</div>
<p>Now fit <span class="math notranslate nohighlight">\(A_c\)</span> and determine the equivalent percentiles as <span class="math notranslate nohighlight">\(A_c\)</span> for the coordinate. Reinstantiate the <code class="docutils literal notranslate"><span class="pre">mi.trait_pdf</span></code> object with this coordinate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj_Ao_pdf_i</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">trait_pdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Ao&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">A_percentile</span> <span class="o">=</span> <span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">cdf</span>
<span class="n">Ac_percentile_to_Ac_coord</span> <span class="o">=</span> <span class="n">obj_Ao_pdf_i</span><span class="o">.</span><span class="n">pdf_func</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">A_percentile</span><span class="p">,</span> <span class="o">*</span><span class="n">obj_Ao_pdf_i</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>

<span class="n">obj_Ao_pdf</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">trait_pdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Ao&#39;</span><span class="p">,</span> <span class="n">coord_data</span><span class="o">=</span><span class="n">Ac_percentile_to_Ac_coord</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obj_Ao_pdf_i</span><span class="o">.</span><span class="n">coord</span><span class="p">,</span> <span class="n">obj_Ao_pdf_i</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;initial&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">,</span> <span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;final&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Trait PDF: Ao&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">attrs_label</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Ao</span><span class="o">.</span><span class="n">attrs</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obj_Ao_pdf_i</span><span class="o">.</span><span class="n">coord</span><span class="p">,</span> <span class="n">obj_Ao_pdf_i</span><span class="o">.</span><span class="n">cdf</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;initial&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">,</span> <span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;final&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Trait CDF: Ao&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">attrs_label</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Ao</span><span class="o">.</span><span class="n">attrs</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Ao&#39;</span><span class="p">:</span> <span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">,</span> <span class="s1">&#39;PDF&#39;</span><span class="p">:</span> <span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="s1">&#39;CDF&#39;</span><span class="p">:</span> <span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ao</th>
      <th>PDF</th>
      <th>CDF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.068106</td>
      <td>1.361252</td>
      <td>0.012578</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.088674</td>
      <td>2.823929</td>
      <td>0.056621</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.114712</td>
      <td>3.713510</td>
      <td>0.143946</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.147614</td>
      <td>3.782377</td>
      <td>0.269404</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.189177</td>
      <td>3.238422</td>
      <td>0.416393</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.241291</td>
      <td>2.430414</td>
      <td>0.563752</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.306919</td>
      <td>1.632652</td>
      <td>0.695479</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.389502</td>
      <td>0.994097</td>
      <td>0.801594</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.492625</td>
      <td>0.555055</td>
      <td>0.878990</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.622110</td>
      <td>0.284666</td>
      <td>0.931125</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.784033</td>
      <td>0.134848</td>
      <td>0.963356</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.987234</td>
      <td>0.058948</td>
      <td>0.981828</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/trait-space-joint-pdf_17_1.png" src="_images/trait-space-joint-pdf_17_1.png" />
</div>
</div>
<p>Now fit <span class="math notranslate nohighlight">\(E_o\)</span>, simple normal distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj_Eo_pdf</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">trait_pdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;Eo&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">])</span>

<span class="c1"># add median trait to percentiles</span>
<span class="n">Eo_percentile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">cdf</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># remake pdf with coord that includes median trait</span>
<span class="n">obj_Eo_pdf</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">trait_pdf</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> <span class="s2">&quot;Eo&quot;</span><span class="p">,</span> <span class="n">coord_data</span><span class="o">=</span><span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">pdf_func</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">Eo_percentile</span><span class="p">,</span> <span class="o">*</span><span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">,</span> <span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="s2">&quot;.-&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Trait PDF: Eo&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">attrs_label</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Eo</span><span class="o">.</span><span class="n">attrs</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">,</span> <span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">,</span> <span class="s2">&quot;.-&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Trait CDF: Eo&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">attrs_label</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Eo</span><span class="o">.</span><span class="n">attrs</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Eo&quot;</span><span class="p">:</span> <span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">,</span> <span class="s2">&quot;PDF&quot;</span><span class="p">:</span> <span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="s2">&quot;CDF&quot;</span><span class="p">:</span> <span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Eo</th>
      <th>PDF</th>
      <th>CDF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.500000</td>
      <td>0.011103</td>
      <td>0.000927</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.305600</td>
      <td>0.074421</td>
      <td>0.007643</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.111100</td>
      <td>0.311325</td>
      <td>0.041096</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.083300</td>
      <td>0.811600</td>
      <td>0.146622</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.277800</td>
      <td>1.319801</td>
      <td>0.358077</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.380678</td>
      <td>1.409992</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.472200</td>
      <td>1.338123</td>
      <td>0.626830</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.666700</td>
      <td>0.845885</td>
      <td>0.843967</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.861100</td>
      <td>0.333549</td>
      <td>0.955243</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.055600</td>
      <td>0.081964</td>
      <td>0.991470</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.250000</td>
      <td>0.012570</td>
      <td>0.998939</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/trait-space-joint-pdf_19_1.png" src="_images/trait-space-joint-pdf_19_1.png" />
</div>
</div>
</section>
<section id="generate-a-low-resolution-trait-space">
<h3>Generate a low-resolution trait space<a class="headerlink" href="#generate-a-low-resolution-trait-space" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gen_trait_space</span><span class="p">(</span><span class="n">obj_Ac_pdf</span><span class="p">,</span> <span class="n">obj_Ao_pdf</span><span class="p">,</span> <span class="n">obj_Eo_pdf</span><span class="p">):</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">)</span>

    <span class="n">dso</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
    <span class="n">dso</span><span class="p">[</span><span class="s1">&#39;Ao_cdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ao&#39;</span><span class="p">))</span>
    <span class="n">dso</span><span class="p">[</span><span class="s1">&#39;Ac_cdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ac&#39;</span><span class="p">))</span>
    <span class="n">dso</span><span class="p">[</span><span class="s1">&#39;Eo_cdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Eo&#39;</span><span class="p">))</span>

    <span class="n">dso</span><span class="p">[</span><span class="s1">&#39;Ao_pdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ao&#39;</span><span class="p">))</span>
    <span class="n">dso</span><span class="p">[</span><span class="s1">&#39;Ac_pdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ac&#39;</span><span class="p">))</span>
    <span class="n">dso</span><span class="p">[</span><span class="s1">&#39;Eo_pdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Eo&#39;</span><span class="p">))</span>

    <span class="c1"># active metabolism</span>
    <span class="n">dso</span><span class="p">[</span><span class="s1">&#39;trait_spc_active&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
        <span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ac&#39;</span><span class="p">),</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Ac&#39;</span><span class="p">:</span> <span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">}</span>
    <span class="p">)</span> <span class="o">*</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Eo&#39;</span><span class="p">),</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Eo&#39;</span><span class="p">:</span> <span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">})</span>

    <span class="n">dso</span><span class="p">[</span><span class="s1">&#39;trait_spc_active&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_active</span> <span class="o">/</span> <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_active</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_active</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_active</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Trait density (active)&#39;</span>
    <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_active</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">coord</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">coord</span><span class="o">.</span><span class="n">units</span><span class="p">])</span>
    <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_active</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;metabolic_baseline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;active&#39;</span>
    <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_active</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;N_traits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_active</span><span class="o">.</span><span class="n">size</span>

    <span class="c1"># resting metabolism</span>
    <span class="n">dso</span><span class="p">[</span><span class="s1">&#39;trait_spc_resting&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
        <span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ao&#39;</span><span class="p">),</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Ao&#39;</span><span class="p">:</span> <span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">}</span>
    <span class="p">)</span> <span class="o">*</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Eo&#39;</span><span class="p">),</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Eo&#39;</span><span class="p">:</span> <span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">coord</span><span class="p">})</span>

    <span class="n">dso</span><span class="p">[</span><span class="s1">&#39;trait_spc_resting&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_resting</span> <span class="o">/</span> <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_resting</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_resting</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_resting</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Trait density (resting)&#39;</span>
    <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_resting</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span><span class="n">obj_Eo_pdf</span><span class="o">.</span><span class="n">coord</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">coord</span><span class="o">.</span><span class="n">units</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_resting</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;metabolic_baseline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;resting&#39;</span>
    <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_resting</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;N_traits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_resting</span><span class="o">.</span><span class="n">size</span>

    <span class="k">return</span> <span class="n">dso</span>


<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">obj_Ao_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">,</span> <span class="n">obj_Ac_pdf</span><span class="o">.</span><span class="n">cdf</span><span class="p">)</span>

<span class="n">dso</span> <span class="o">=</span> <span class="n">gen_trait_space</span><span class="p">(</span><span class="n">obj_Ac_pdf</span><span class="p">,</span> <span class="n">obj_Ao_pdf</span><span class="p">,</span> <span class="n">obj_Eo_pdf</span><span class="p">)</span>
<span class="n">dso</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:            (Ao: 12, Ac: 12, Eo: 11)
Coordinates:
  * Ao                 (Ao) float64 0.06811 0.08867 0.1147 ... 0.784 0.9872
  * Ac                 (Ac) float64 0.03 0.037 0.0456 ... 0.1974 0.2433 0.3
  * Eo                 (Eo) float64 -0.5 -0.3056 -0.1111 ... 0.8611 1.056 1.25
Data variables:
    Ao_cdf             (Ao) float64 0.01258 0.05662 0.1439 ... 0.9634 0.9818
    Ac_cdf             (Ac) float64 0.01258 0.05662 0.1439 ... 0.9634 0.9818
    Eo_cdf             (Eo) float64 0.0009272 0.007643 0.0411 ... 0.9915 0.9989
    Ao_pdf             (Ao) float64 1.361 2.824 3.714 ... 0.2847 0.1348 0.05895
    Ac_pdf             (Ac) float64 3.927 8.428 11.39 ... 0.996 0.4794 0.2129
    Eo_pdf             (Eo) float64 0.0111 0.07442 0.3113 ... 0.08196 0.01257
    trait_spc_active   (Ac, Eo) float64 0.0001004 0.0006727 ... 6.159e-06
    trait_spc_resting  (Ao, Eo) float64 0.0001098 0.0007361 ... 5.384e-06</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-c4eb498b-21fb-487a-a9e0-ec8dcde35659' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c4eb498b-21fb-487a-a9e0-ec8dcde35659' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>Ao</span>: 12</li><li><span class='xr-has-index'>Ac</span>: 12</li><li><span class='xr-has-index'>Eo</span>: 11</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-67d9b563-09ea-4e33-87d4-4e944b675c2e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-67d9b563-09ea-4e33-87d4-4e944b675c2e' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Ao</span></div><div class='xr-var-dims'>(Ao)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.06811 0.08867 ... 0.784 0.9872</div><input id='attrs-2f124390-6e87-4a86-aba7-7eaf9c512afb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2f124390-6e87-4a86-aba7-7eaf9c512afb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1f2d57c3-1097-4d8f-ab4f-bd1054d8cf15' class='xr-var-data-in' type='checkbox'><label for='data-1f2d57c3-1097-4d8f-ab4f-bd1054d8cf15' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Hypoxic tolerance</dd><dt><span>units :</span></dt><dd>1/kPa</dd></dl></div><div class='xr-var-data'><pre>array([0.068106, 0.088674, 0.114712, 0.147614, 0.189177, 0.241291, 0.306919,
       0.389502, 0.492625, 0.62211 , 0.784033, 0.987234])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Ac</span></div><div class='xr-var-dims'>(Ac)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.03 0.037 0.0456 ... 0.2433 0.3</div><input id='attrs-0eddf276-e842-4213-b60e-9a07230ea942' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0eddf276-e842-4213-b60e-9a07230ea942' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-324da9fb-4867-4cb6-b844-84640cb7bc4e' class='xr-var-data-in' type='checkbox'><label for='data-324da9fb-4867-4cb6-b844-84640cb7bc4e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Hypoxic tolerance (normalized by $\Phi_{crit}$)</dd><dt><span>units :</span></dt><dd>1/kPa</dd></dl></div><div class='xr-var-data'><pre>array([0.03  , 0.037 , 0.0456, 0.0562, 0.0693, 0.0854, 0.1053, 0.1299, 0.1601,
       0.1974, 0.2433, 0.3   ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Eo</span></div><div class='xr-var-dims'>(Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.5 -0.3056 -0.1111 ... 1.056 1.25</div><input id='attrs-de1fd1c6-1c10-4633-ab2b-e788eba7ecd4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-de1fd1c6-1c10-4633-ab2b-e788eba7ecd4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-34198438-4fff-4d67-bd01-b9c1b87642fa' class='xr-var-data-in' type='checkbox'><label for='data-34198438-4fff-4d67-bd01-b9c1b87642fa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Temperature sensitivity</dd><dt><span>units :</span></dt><dd>eV</dd></dl></div><div class='xr-var-data'><pre>array([-0.5     , -0.3056  , -0.1111  ,  0.0833  ,  0.2778  ,  0.380678,
        0.4722  ,  0.6667  ,  0.8611  ,  1.0556  ,  1.25    ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-27843b7c-b48d-420d-a3b2-d32cb1e13809' class='xr-section-summary-in' type='checkbox'  checked><label for='section-27843b7c-b48d-420d-a3b2-d32cb1e13809' class='xr-section-summary' >Data variables: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Ao_cdf</span></div><div class='xr-var-dims'>(Ao)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.01258 0.05662 ... 0.9634 0.9818</div><input id='attrs-1ae80ae7-9e21-48e9-99ed-a7db3aeb1aed' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1ae80ae7-9e21-48e9-99ed-a7db3aeb1aed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-94fec1c2-acb3-48e8-a2dc-09b87e9158f8' class='xr-var-data-in' type='checkbox'><label for='data-94fec1c2-acb3-48e8-a2dc-09b87e9158f8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.01257777, 0.05662097, 0.14394613, 0.26940383, 0.4163934 ,
       0.56375229, 0.6954788 , 0.80159361, 0.87899004, 0.93112507,
       0.96335562, 0.98182818])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Ac_cdf</span></div><div class='xr-var-dims'>(Ac)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.01258 0.05662 ... 0.9634 0.9818</div><input id='attrs-3bac75a9-0536-4373-bbaf-8a500ae2ec07' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3bac75a9-0536-4373-bbaf-8a500ae2ec07' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a0df32d0-a94c-4349-88c8-ce5a5d773578' class='xr-var-data-in' type='checkbox'><label for='data-a0df32d0-a94c-4349-88c8-ce5a5d773578' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.01257777, 0.05662097, 0.14394613, 0.26940383, 0.4163934 ,
       0.56375229, 0.6954788 , 0.80159361, 0.87899004, 0.93112507,
       0.96335562, 0.98182818])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Eo_cdf</span></div><div class='xr-var-dims'>(Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0009272 0.007643 ... 0.9989</div><input id='attrs-edb7b4cd-3ce6-4e68-93ae-92186669b7ea' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-edb7b4cd-3ce6-4e68-93ae-92186669b7ea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ca7e877b-1495-4b2c-ac60-cc05abca67d7' class='xr-var-data-in' type='checkbox'><label for='data-ca7e877b-1495-4b2c-ac60-cc05abca67d7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([9.27227238e-04, 7.64303444e-03, 4.10963306e-02, 1.46622432e-01,
       3.58077128e-01, 5.00000000e-01, 6.26830276e-01, 8.43966994e-01,
       9.55243246e-01, 9.91469630e-01, 9.98938522e-01])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Ao_pdf</span></div><div class='xr-var-dims'>(Ao)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.361 2.824 ... 0.1348 0.05895</div><input id='attrs-b3efdb5c-394c-43b9-981f-95e98038e120' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b3efdb5c-394c-43b9-981f-95e98038e120' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0b43fbf2-8cac-49af-8e86-493e5ce9fb8d' class='xr-var-data-in' type='checkbox'><label for='data-0b43fbf2-8cac-49af-8e86-493e5ce9fb8d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1.36125156, 2.82392897, 3.71350972, 3.78237708, 3.23842168,
       2.43041355, 1.63265246, 0.99409667, 0.55505541, 0.28466603,
       0.13484826, 0.05894828])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Ac_pdf</span></div><div class='xr-var-dims'>(Ac)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.927 8.428 11.39 ... 0.4794 0.2129</div><input id='attrs-191fadf7-2f83-4195-af33-1c2c37126fd4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-191fadf7-2f83-4195-af33-1c2c37126fd4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f7aa8795-0362-47d8-a68d-49bf3ae8e35f' class='xr-var-data-in' type='checkbox'><label for='data-f7aa8795-0362-47d8-a68d-49bf3ae8e35f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 3.92680296,  8.42757271, 11.38573265, 11.86938536, 10.37716577,
        7.93944485,  5.43129161,  3.36510266,  1.91059171,  0.99595784,
        0.47935406,  0.21285338])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Eo_pdf</span></div><div class='xr-var-dims'>(Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0111 0.07442 ... 0.08196 0.01257</div><input id='attrs-43cd20e8-1227-4f7f-9ce8-8fe65ccf9b96' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-43cd20e8-1227-4f7f-9ce8-8fe65ccf9b96' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-51c01a07-ff4a-480b-930e-b96ebcc5d6cb' class='xr-var-data-in' type='checkbox'><label for='data-51c01a07-ff4a-480b-930e-b96ebcc5d6cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.01110274, 0.07442134, 0.31132536, 0.81160007, 1.31980058,
       1.40999242, 1.3381231 , 0.84588535, 0.33354884, 0.08196417,
       0.01256991])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>trait_spc_active</span></div><div class='xr-var-dims'>(Ac, Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0001004 0.0006727 ... 6.159e-06</div><input id='attrs-8b9dc8ad-134e-4bd9-ae46-e72a84b17229' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8b9dc8ad-134e-4bd9-ae46-e72a84b17229' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d8b259b0-c33f-4927-9708-8dc956b4cbb1' class='xr-var-data-in' type='checkbox'><label for='data-d8b259b0-c33f-4927-9708-8dc956b4cbb1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Trait density (active)</dd><dt><span>units :</span></dt><dd>eV 1/kPa</dd><dt><span>metabolic_baseline :</span></dt><dd>active</dd><dt><span>N_traits :</span></dt><dd>132</dd></dl></div><div class='xr-var-data'><pre>array([[1.00358230e-04, 6.72698399e-04, 2.81408643e-03, 7.33609608e-03,
        1.19297474e-02, 1.27449962e-02, 1.20953656e-02, 7.64600251e-03,
        3.01496564e-03, 7.40878515e-04, 1.13620084e-04],
       [2.15385464e-04, 1.44372273e-03, 6.03949784e-03, 1.57444832e-02,
        2.56032234e-02, 2.73528831e-02, 2.59586678e-02, 1.64095940e-02,
        6.47061807e-03, 1.59004860e-03, 2.43847612e-04],
       [2.90987855e-04, 1.95048344e-03, 8.15942028e-03, 2.12709498e-02,
        3.45902036e-02, 3.69540110e-02, 3.50704125e-02, 2.21695209e-02,
        8.74186790e-03, 2.14817112e-03, 3.29440494e-04],
       [3.03348682e-04, 2.03333771e-03, 8.50602299e-03, 2.21745151e-02,
        3.60595553e-02, 3.85237745e-02, 3.65601629e-02, 2.31112565e-02,
        9.11321231e-03, 2.23942293e-03, 3.43434744e-04],
       [2.65211673e-04, 1.77770641e-03, 7.43664545e-03, 1.93867342e-02,
        3.15261466e-02, 3.36805640e-02, 3.19638178e-02, 2.02057084e-02,
        7.96749890e-03, 1.95788259e-03, 3.00258114e-04],
       [2.02910265e-04, 1.36010182e-03, 5.68968808e-03, 1.48325574e-02,
        2.41202760e-02, 2.57685949e-02, 2.44551330e-02, 1.54591447e-02,
        6.09583768e-03, 1.49795245e-03, 2.29723876e-04],
       [1.38808801e-04, 9.30431502e-04, 3.89225641e-03, 1.01467982e-02,
        1.65004298e-02, 1.76280276e-02, 1.67295020e-02, 1.05754401e-02,
        4.17009913e-03, 1.02473368e-03, 1.57151713e-04],
       [8.60027226e-05, 5.76473839e-04, 2.41155205e-03, 6.28672147e-03,
        1.02232847e-02, 1.09219182e-02, 1.03652125e-02, 6.55229806e-03,
        2.58369697e-03, 6.34901290e-04, 9.73675666e-05],
       [4.88294430e-05, 3.27302387e-04, 1.36919786e-03, 3.56938825e-03,
        5.80443598e-03, 6.20109650e-03, 5.88501779e-03, 3.72017367e-03,
        1.46693593e-03, 3.60475522e-04, 5.52820178e-05],
       [2.54539295e-05, 1.70616976e-04, 7.13738753e-04, 1.86065930e-03,
        3.02575035e-03, 3.23252251e-03, 3.06775624e-03, 1.93926109e-03,
        7.64687892e-04, 1.87909548e-04, 2.88175433e-05],
       [1.22509648e-05, 8.21178736e-05, 3.43522140e-04, 8.95534480e-04,
        1.45629228e-03, 1.55581163e-03, 1.47650969e-03, 9.33365485e-04,
        3.68043938e-04, 9.04407805e-05, 1.38698706e-05],
       [5.43994403e-06, 3.64637924e-05, 1.52538289e-04, 3.97655003e-04,
        6.46655070e-04, 6.90845848e-04, 6.55632452e-04, 4.14453562e-04,
        1.63427000e-04, 4.01595133e-05, 6.15880634e-06]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>trait_spc_resting</span></div><div class='xr-var-dims'>(Ao, Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0001098 0.0007361 ... 5.384e-06</div><input id='attrs-70507aa1-2fd7-4738-8903-c3f40dca9559' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-70507aa1-2fd7-4738-8903-c3f40dca9559' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2d48c32d-deb3-47ea-b74b-e1b5722e3c55' class='xr-var-data-in' type='checkbox'><label for='data-2d48c32d-deb3-47ea-b74b-e1b5722e3c55' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Trait density (resting)</dd><dt><span>units :</span></dt><dd>eV 1/kPa</dd><dt><span>metabolic_baseline :</span></dt><dd>resting</dd><dt><span>N_traits :</span></dt><dd>132</dd></dl></div><div class='xr-var-data'><pre>array([[1.09818486e-04, 7.36110232e-04, 3.07935594e-03, 8.02763229e-03,
        1.30543035e-02, 1.39464018e-02, 1.32355338e-02, 8.36675201e-03,
        3.29917101e-03, 8.10717338e-04, 1.24330468e-04],
       [2.27819466e-04, 1.52706750e-03, 6.38815243e-03, 1.66533975e-02,
        2.70812736e-02, 2.89319396e-02, 2.74572375e-02, 1.73569046e-02,
        6.84416083e-03, 1.68184063e-03, 2.57924708e-04],
       [2.99586077e-04, 2.00811708e-03, 8.40051800e-03, 2.18994721e-02,
        3.56122884e-02, 3.80459425e-02, 3.61066867e-02, 2.28245946e-02,
        9.00017601e-03, 2.21164611e-03, 3.39174929e-04],
       [3.05141927e-04, 2.04535778e-03, 8.55630634e-03, 2.23055997e-02,
        3.62727214e-02, 3.87515078e-02, 3.67762883e-02, 2.32478787e-02,
        9.16708506e-03, 2.25266128e-03, 3.45464958e-04],
       [2.61258518e-04, 1.75120853e-03, 7.32579734e-03, 1.90977621e-02,
        3.10562286e-02, 3.31785330e-02, 3.14873760e-02, 1.99045290e-02,
        7.84873807e-03, 1.92869906e-03, 2.95782569e-04],
       [1.96072750e-04, 1.31427014e-03, 5.49796131e-03, 1.43327412e-02,
        2.33074893e-02, 2.49002644e-02, 2.36310625e-02, 1.49382143e-02,
        5.89042479e-03, 1.44747559e-03, 2.21982816e-04],
       [1.31713657e-04, 8.82872952e-04, 3.69330564e-03, 9.62814957e-03,
        1.56570185e-02, 1.67269797e-02, 1.58743817e-02, 1.00348816e-02,
        3.95694656e-03, 9.72354925e-04, 1.49118980e-04],
       [8.01983957e-05, 5.37567598e-04, 2.24879632e-03, 5.86243041e-03,
        9.53331485e-03, 1.01847976e-02, 9.66566394e-03, 6.11008323e-03,
        2.40932317e-03, 5.92051779e-04, 9.07962261e-05],
       [4.47788981e-05, 3.00151699e-04, 1.25561890e-03, 3.27329707e-03,
        5.32294107e-03, 5.68669745e-03, 5.39683839e-03, 3.41157441e-03,
        1.34524931e-03, 3.30573025e-04, 5.06962131e-05],
       [2.29653307e-05, 1.53935968e-04, 6.43957410e-04, 1.67874497e-03,
        2.72992653e-03, 2.91648283e-03, 2.76782556e-03, 1.74966196e-03,
        6.89925315e-04, 1.69537867e-04, 2.60000882e-05],
       [1.08788352e-05, 7.29205276e-05, 3.05047057e-04, 7.95233045e-04,
        1.29318499e-03, 1.38155799e-03, 1.31113801e-03, 8.28826912e-04,
        3.26822370e-04, 8.03112542e-05, 1.23164207e-05],
       [4.75563148e-06, 3.18768645e-05, 1.33349881e-04, 3.47632373e-04,
        5.65309715e-04, 6.03941556e-04, 5.73157796e-04, 3.62317773e-04,
        1.42868857e-04, 3.51076858e-05, 5.38406520e-06]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9bb895b3-339c-4bdf-8ca8-5d1a85de5155' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9bb895b3-339c-4bdf-8ca8-5d1a85de5155' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_active</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/trait-space-joint-pdf_22_0.png" src="_images/trait-space-joint-pdf_22_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dso</span><span class="o">.</span><span class="n">trait_spc_resting</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/trait-space-joint-pdf_23_0.png" src="_images/trait-space-joint-pdf_23_0.png" />
</div>
</div>
</section>
<section id="generate-a-higher-resolution-version-of-trait-space">
<h3>Generate a higher resolution version of trait space<a class="headerlink" href="#generate-a-higher-resolution-version-of-trait-space" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dso_hires</span> <span class="o">=</span> <span class="n">gen_trait_space</span><span class="p">(</span>
    <span class="n">mi</span><span class="o">.</span><span class="n">trait_pdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Ac&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Ac</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">Ac</span><span class="o">.</span><span class="n">max</span><span class="p">()]),</span>
    <span class="n">mi</span><span class="o">.</span><span class="n">trait_pdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Ao&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Ao</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">Ao</span><span class="o">.</span><span class="n">max</span><span class="p">()]),</span>
    <span class="n">mi</span><span class="o">.</span><span class="n">trait_pdf</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Eo&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">dso_hires</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:            (Ao: 30, Ac: 30, Eo: 30)
Coordinates:
  * Ao                 (Ao) float64 0.0613 0.0684 0.0762 ... 1.15 1.282 1.429
  * Ac                 (Ac) float64 0.0258 0.0287 0.0319 ... 0.4973 0.5528
  * Eo                 (Eo) float64 -1.0 -0.8966 -0.7931 ... 1.793 1.897 2.0
Data variables:
    Ao_cdf             (Ao) float64 0.005202 0.01298 0.02624 ... 0.9925 0.9949
    Ac_cdf             (Ac) float64 0.002015 0.008067 0.02132 ... 0.9975 0.9984
    Eo_cdf             (Eo) float64 5.311e-07 3.176e-06 1.673e-05 ... 1.0 1.0
    Ao_pdf             (Ao) float64 0.811 1.385 2.005 ... 0.02088 0.01315
    Ac_pdf             (Ac) float64 1.239 3.018 5.267 ... 0.03646 0.02182 0.0128
    Eo_pdf             (Eo) float64 9.517e-06 5.296e-05 ... 8.239e-07 1.088e-07
    trait_spc_active   (Ac, Eo) float64 9.205e-09 5.123e-08 ... 1.087e-12
    trait_spc_resting  (Ao, Eo) float64 1.651e-08 9.187e-08 ... 3.06e-12</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-cf7842d5-3fad-419f-9868-363d0ed9d001' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-cf7842d5-3fad-419f-9868-363d0ed9d001' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>Ao</span>: 30</li><li><span class='xr-has-index'>Ac</span>: 30</li><li><span class='xr-has-index'>Eo</span>: 30</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-548003dd-a554-4a38-a49c-11dd1c79484e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-548003dd-a554-4a38-a49c-11dd1c79484e' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Ao</span></div><div class='xr-var-dims'>(Ao)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0613 0.0684 ... 1.282 1.429</div><input id='attrs-8798ea3f-dba6-4a33-a4a9-45eee049be58' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8798ea3f-dba6-4a33-a4a9-45eee049be58' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9b92f235-8912-4ac7-a7e9-f696148accc2' class='xr-var-data-in' type='checkbox'><label for='data-9b92f235-8912-4ac7-a7e9-f696148accc2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Hypoxic tolerance</dd><dt><span>units :</span></dt><dd>1/kPa</dd></dl></div><div class='xr-var-data'><pre>array([0.0613, 0.0684, 0.0762, 0.085 , 0.0947, 0.1056, 0.1177, 0.1311, 0.1462,
       0.163 , 0.1816, 0.2025, 0.2257, 0.2516, 0.2804, 0.3126, 0.3484, 0.3884,
       0.4329, 0.4826, 0.5379, 0.5996, 0.6684, 0.745 , 0.8304, 0.9257, 1.0318,
       1.1502, 1.2821, 1.4291])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Ac</span></div><div class='xr-var-dims'>(Ac)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0258 0.0287 ... 0.4973 0.5528</div><input id='attrs-512e1a72-390e-4271-878e-d4a5554333dd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-512e1a72-390e-4271-878e-d4a5554333dd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4ec1a8a2-631a-424a-a622-be067e3699de' class='xr-var-data-in' type='checkbox'><label for='data-4ec1a8a2-631a-424a-a622-be067e3699de' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Hypoxic tolerance (normalized by $\Phi_{crit}$)</dd><dt><span>units :</span></dt><dd>1/kPa</dd></dl></div><div class='xr-var-data'><pre>array([0.0258, 0.0287, 0.0319, 0.0354, 0.0393, 0.0437, 0.0486, 0.054 , 0.0601,
       0.0668, 0.0742, 0.0825, 0.0917, 0.1019, 0.1132, 0.1259, 0.1399, 0.1555,
       0.1728, 0.1921, 0.2135, 0.2373, 0.2638, 0.2932, 0.3259, 0.3622, 0.4026,
       0.4474, 0.4973, 0.5528])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Eo</span></div><div class='xr-var-dims'>(Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.0 -0.8966 -0.7931 ... 1.897 2.0</div><input id='attrs-3a408a8e-041b-4c76-9508-e5c5ea56e743' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3a408a8e-041b-4c76-9508-e5c5ea56e743' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc271593-826b-48a0-90ae-778cf71d056f' class='xr-var-data-in' type='checkbox'><label for='data-cc271593-826b-48a0-90ae-778cf71d056f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Temperature sensitivity</dd><dt><span>units :</span></dt><dd>eV</dd></dl></div><div class='xr-var-data'><pre>array([-1.    , -0.8966, -0.7931, -0.6897, -0.5862, -0.4828, -0.3793, -0.2759,
       -0.1724, -0.069 ,  0.0345,  0.1379,  0.2414,  0.3448,  0.4483,  0.5517,
        0.6552,  0.7586,  0.8621,  0.9655,  1.069 ,  1.1724,  1.2759,  1.3793,
        1.4828,  1.5862,  1.6897,  1.7931,  1.8966,  2.    ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1065585e-bd37-411a-ab45-84fad1b1eb51' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1065585e-bd37-411a-ab45-84fad1b1eb51' class='xr-section-summary' >Data variables: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Ao_cdf</span></div><div class='xr-var-dims'>(Ao)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.005202 0.01298 ... 0.9925 0.9949</div><input id='attrs-717edff7-42b5-421c-bd7a-d3ae58d01f31' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-717edff7-42b5-421c-bd7a-d3ae58d01f31' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7f534f47-1c56-4dc2-9d12-0ea94944aaf4' class='xr-var-data-in' type='checkbox'><label for='data-7f534f47-1c56-4dc2-9d12-0ea94944aaf4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.00520241, 0.01298092, 0.02623678, 0.04663099, 0.07457302,
       0.11092896, 0.15510859, 0.20621759, 0.26404914, 0.3264472 ,
       0.39140682, 0.45812822, 0.52407508, 0.58805579, 0.64847728,
       0.7045947 , 0.7553323 , 0.80049496, 0.83972538, 0.8732709 ,
       0.90130137, 0.92434822, 0.94292975, 0.95761412, 0.96902353,
       0.97773296, 0.98424565, 0.98903897, 0.99249692, 0.99494807])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Ac_cdf</span></div><div class='xr-var-dims'>(Ac)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.002015 0.008067 ... 0.9975 0.9984</div><input id='attrs-015b05a9-b2e4-4c7f-a2f9-a81820b29aa7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-015b05a9-b2e4-4c7f-a2f9-a81820b29aa7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-69a51b74-a9f6-4981-b0b8-f0a7bb408c68' class='xr-var-data-in' type='checkbox'><label for='data-69a51b74-a9f6-4981-b0b8-f0a7bb408c68' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.00201465, 0.00806659, 0.02131592, 0.04383484, 0.07730011,
       0.12267857, 0.17877878, 0.24318113, 0.31514691, 0.3899961 ,
       0.46543487, 0.54011167, 0.61096385, 0.67638687, 0.73523939,
       0.78760061, 0.83221929, 0.86982187, 0.90067709, 0.92560411,
       0.94520082, 0.96034407, 0.97181937, 0.98031174, 0.98648997,
       0.99088865, 0.99396728, 0.99607296, 0.99749172, 0.99842714])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Eo_cdf</span></div><div class='xr-var-dims'>(Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.311e-07 3.176e-06 ... 1.0 1.0</div><input id='attrs-f8bbd6a0-79c9-4d17-871e-cf664cb43dde' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f8bbd6a0-79c9-4d17-871e-cf664cb43dde' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-97786a3b-740c-41aa-8e19-2c59db637a01' class='xr-var-data-in' type='checkbox'><label for='data-97786a3b-740c-41aa-8e19-2c59db637a01' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([5.31058413e-07, 3.17606039e-06, 1.67320224e-05, 7.74546073e-05,
       3.16272186e-04, 1.13732134e-03, 3.61555167e-03, 1.01552989e-02,
       2.53058636e-02, 5.59954516e-02, 1.10569501e-01, 1.95430871e-01,
       3.11270319e-01, 4.49547999e-01, 5.94446985e-01, 7.27227358e-01,
       8.34039465e-01, 9.09176497e-01, 9.55575795e-01, 9.80630722e-01,
       9.92507805e-01, 9.97430630e-01, 9.99221938e-01, 9.99791794e-01,
       9.99950953e-01, 9.99989811e-01, 9.99998141e-01, 9.99999701e-01,
       9.99999958e-01, 9.99999995e-01])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Ao_pdf</span></div><div class='xr-var-dims'>(Ao)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.811 1.385 ... 0.02088 0.01315</div><input id='attrs-e4be3dc3-2019-4d41-8cab-e00b3a958752' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e4be3dc3-2019-4d41-8cab-e00b3a958752' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d5f5418-0de8-4caa-a3fd-762b46b536e1' class='xr-var-data-in' type='checkbox'><label for='data-5d5f5418-0de8-4caa-a3fd-762b46b536e1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.81104388, 1.38534363, 2.00480586, 2.60972994, 3.12420599,
       3.51575979, 3.75672236, 3.84536619, 3.79317316, 3.62037886,
       3.35634317, 3.02620171, 2.66171168, 2.28570512, 1.91978109,
       1.57701813, 1.26931149, 1.00054741, 0.77355757, 0.58622162,
       0.43604067, 0.31816038, 0.22781279, 0.16018241, 0.11056183,
       0.07489202, 0.04983468, 0.03254653, 0.02087793, 0.01315266])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Ac_pdf</span></div><div class='xr-var-dims'>(Ac)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.239 3.018 ... 0.02182 0.0128</div><input id='attrs-4ec3e0d0-4303-48e2-b053-638522eb7b2f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4ec3e0d0-4303-48e2-b053-638522eb7b2f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4b0a73d4-b4a2-4416-a8c7-80ff13ddee0c' class='xr-var-data-in' type='checkbox'><label for='data-4b0a73d4-b4a2-4416-a8c7-80ff13ddee0c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1.23876848,  3.01837817,  5.2673401 ,  7.53746647,  9.51618678,
       10.9803876 , 11.79181939, 11.95723713, 11.5603703 , 10.7375908 ,
        9.63463566,  8.36647986,  7.06041057,  5.8031375 ,  4.65444041,
        3.63510598,  2.78021343,  2.07818641,  1.52125463,  1.08899078,
        0.76418329,  0.52529401,  0.35362585,  0.23352051,  0.15113263,
        0.09595334,  0.05969813,  0.03646168,  0.02181511,  0.01279546])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Eo_pdf</span></div><div class='xr-var-dims'>(Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.517e-06 5.296e-05 ... 1.088e-07</div><input id='attrs-cceb2c89-d59e-4480-aa72-9722a4be783a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cceb2c89-d59e-4480-aa72-9722a4be783a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0efbbd76-09e1-4e90-b800-fcbe9b02889b' class='xr-var-data-in' type='checkbox'><label for='data-0efbbd76-09e1-4e90-b800-fcbe9b02889b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([9.51658313e-06, 5.29615859e-05, 2.58271372e-04, 1.10026481e-03,
       4.10621120e-03, 1.33906991e-02, 3.82451250e-02, 9.54726696e-02,
       2.08679926e-01, 3.98772014e-01, 6.67044874e-01, 9.75753380e-01,
       1.24910578e+00, 1.39870216e+00, 1.37029215e+00, 1.17457354e+00,
       8.80636969e-01, 5.77836501e-01, 3.31551077e-01, 1.66532698e-01,
       7.31263272e-02, 2.81166679e-02, 9.44858704e-03, 2.78098069e-03,
       7.15203717e-04, 1.61139453e-04, 3.17148342e-05, 5.46985208e-06,
       8.23881814e-07, 1.08772490e-07])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>trait_spc_active</span></div><div class='xr-var-dims'>(Ac, Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.205e-09 5.123e-08 ... 1.087e-12</div><input id='attrs-782c87e3-f8f5-4836-a05b-708297743d24' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-782c87e3-f8f5-4836-a05b-708297743d24' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f82fcf1d-ef8c-40c8-a5e7-cb2135a2249d' class='xr-var-data-in' type='checkbox'><label for='data-f82fcf1d-ef8c-40c8-a5e7-cb2135a2249d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Trait density (active)</dd><dt><span>units :</span></dt><dd>eV 1/kPa</dd><dt><span>metabolic_baseline :</span></dt><dd>active</dd><dt><span>N_traits :</span></dt><dd>900</dd></dl></div><div class='xr-var-data'><pre>array([[9.20538601e-09, 5.12297151e-08, 2.49825767e-07, 1.06428559e-06,
        3.97193600e-06, 1.29528164e-05, 3.69944899e-05, 9.23506647e-05,
        2.01855986e-04, 3.85731966e-04, 6.45232167e-04, 9.43845748e-04,
        1.20825938e-03, 1.35296389e-03, 1.32548290e-03, 1.13616439e-03,
        8.51839691e-04, 5.58940953e-04, 3.20709188e-04, 1.61086994e-04,
        7.07350591e-05, 2.71972386e-05, 9.13961343e-06, 2.69004121e-06,
        6.91816191e-07, 1.55870110e-07, 3.06777430e-08, 5.29098513e-09,
        7.96940459e-10, 1.05215574e-10],
       [2.24298055e-08, 1.24826112e-07, 6.08724432e-07, 2.59323386e-06,
        9.67800286e-06, 3.15607789e-05, 9.01406213e-05, 2.25021248e-04,
        4.91841462e-04, 9.39872914e-04, 1.57217003e-03, 2.29977065e-03,
        2.94403982e-03, 3.29662622e-03, 3.22966616e-03, 2.76837346e-03,
        2.07558907e-03, 1.36191322e-03, 7.81438683e-04, 3.92503904e-04,
        1.72352753e-04, 6.62686792e-05, 2.22695443e-05, 6.55454329e-06,
        1.68567647e-06, 3.79792467e-07, 7.47492618e-08, 1.28919925e-08,
        1.94182183e-09, 2.56367832e-10],
       [3.91420184e-08, 2.17832739e-07, 1.06227862e-06, 4.52542522e-06,
        1.68889813e-05, 5.50763843e-05, 1.57303453e-04, 3.92682221e-04,
        8.58307378e-04, 1.64016237e-03, 2.74357744e-03, 4.01330565e-03,
        5.13761302e-03, 5.75290784e-03, 5.63605656e-03, 4.83105950e-03,
...
        2.50728876e-05, 1.64517618e-05, 9.43969330e-06, 4.74140397e-06,
        2.08200229e-06, 8.00518352e-07, 2.69013645e-07, 7.91781617e-08,
        2.03627863e-08, 4.58785121e-09, 9.02962857e-10, 1.55733851e-10,
        2.34569940e-11, 3.09689520e-12],
       [1.62109798e-10, 9.02171702e-10, 4.39951183e-09, 1.87424103e-08,
        6.99470661e-08, 2.28103248e-07, 6.51484825e-07, 1.62632481e-06,
        3.55474861e-06, 6.79286355e-06, 1.13627453e-05, 1.66214261e-05,
        2.12778350e-05, 2.38261277e-05, 2.33421787e-05, 2.00082191e-05,
        1.50011700e-05, 9.84312934e-06, 5.64779159e-06, 2.83679359e-06,
        1.24566706e-06, 4.78952088e-07, 1.60951522e-07, 4.73724879e-08,
        1.21831049e-08, 2.74492260e-09, 5.40244887e-10, 9.31759441e-11,
        1.40343769e-11, 1.85287998e-12],
       [9.50840871e-11, 5.29160937e-10, 2.58049526e-09, 1.09931972e-08,
        4.10268411e-08, 1.33791969e-07, 3.82122737e-07, 9.53906619e-07,
        2.08500677e-06, 3.98429482e-06, 6.66471906e-06, 9.74915241e-06,
        1.24803284e-05, 1.39750072e-05, 1.36911512e-05, 1.17356463e-05,
        8.79880531e-06, 5.77340159e-06, 3.31266286e-06, 1.66389652e-06,
        7.30635142e-07, 2.80925167e-07, 9.44047102e-08, 2.77859192e-08,
        7.14589381e-09, 1.61001039e-09, 3.16875923e-10, 5.46515367e-11,
        8.23174128e-12, 1.08679058e-12]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>trait_spc_resting</span></div><div class='xr-var-dims'>(Ao, Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.651e-08 9.187e-08 ... 3.06e-12</div><input id='attrs-0b5a4957-7289-4625-98b2-a8bc03b8d64d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0b5a4957-7289-4625-98b2-a8bc03b8d64d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-19275d6c-985a-4a4c-8719-3b8fb7e98086' class='xr-var-data-in' type='checkbox'><label for='data-19275d6c-985a-4a4c-8719-3b8fb7e98086' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Trait density (resting)</dd><dt><span>units :</span></dt><dd>eV 1/kPa</dd><dt><span>metabolic_baseline :</span></dt><dd>resting</dd><dt><span>N_traits :</span></dt><dd>900</dd></dl></div><div class='xr-var-data'><pre>array([[1.65084730e-08, 9.18727759e-08, 4.48024875e-07, 1.90863586e-06,
        7.12306883e-06, 2.32289248e-05, 6.63440442e-05, 1.65617004e-04,
        3.61998300e-04, 6.91752168e-04, 1.15712668e-03, 1.69264515e-03,
        2.16683117e-03, 2.42633690e-03, 2.37705389e-03, 2.03753967e-03,
        1.52764615e-03, 1.00237639e-03, 5.75143612e-04, 2.88885255e-04,
        1.26852672e-04, 4.87741499e-05, 1.63905197e-05, 4.82418363e-06,
        1.24066811e-06, 2.79529560e-07, 5.50159103e-08, 9.48858472e-09,
        1.42919265e-09, 1.88688280e-10],
       [2.81981142e-08, 1.56927841e-07, 7.65271059e-07, 3.26013993e-06,
        1.21669102e-05, 3.96773144e-05, 1.13322228e-04, 2.82890319e-04,
        6.18329110e-04, 1.18158152e-03, 1.97648749e-03, 2.89120631e-03,
        3.70116321e-03, 4.14442481e-03, 4.06024453e-03, 3.48032045e-03,
        2.60937160e-03, 1.71215860e-03, 9.82402507e-04, 4.93444755e-04,
        2.16676983e-04, 8.33111004e-05, 2.79966383e-05, 8.24018558e-06,
        2.11918456e-06, 4.77464298e-07, 9.39726480e-08, 1.62074467e-08,
        2.44120323e-09, 3.22298354e-10],
       [4.08070196e-08, 2.27098786e-07, 1.10746523e-06, 4.71792521e-06,
        1.76073953e-05, 5.74191925e-05, 1.63994739e-04, 4.09385916e-04,
        8.94817574e-04, 1.70993067e-03, 2.86028219e-03, 4.18402138e-03,
        5.35615391e-03, 5.99762180e-03, 5.87579996e-03, 5.03656039e-03,
...
        6.13032012e-05, 4.02245517e-05, 2.30800467e-05, 1.15927310e-05,
        5.09049485e-06, 1.95726708e-06, 6.57738265e-07, 1.93590577e-07,
        4.97870052e-08, 1.12172946e-08, 2.20774386e-09, 3.80769210e-10,
        5.73523420e-11, 7.57190766e-12],
       [4.24961946e-10, 2.36499364e-09, 1.15330790e-08, 4.91322008e-08,
        1.83362398e-07, 5.97960156e-07, 1.70783174e-06, 4.26332129e-06,
        9.31857855e-06, 1.78071193e-05, 2.97868136e-05, 4.35721571e-05,
        5.57786776e-05, 6.24588872e-05, 6.11902415e-05, 5.24504491e-05,
        3.93247445e-05, 2.58032238e-05, 1.48053759e-05, 7.43649884e-06,
        3.26544789e-06, 1.25554663e-06, 4.21925588e-07, 1.24184379e-07,
        3.19373413e-08, 7.19566407e-09, 1.41622234e-09, 2.44255628e-10,
        3.67903495e-11, 4.85722325e-12],
       [2.67717127e-10, 1.48989647e-09, 7.26559827e-09, 3.09522577e-08,
        1.15514471e-07, 3.76702377e-07, 1.07589824e-06, 2.68580314e-06,
        5.87050936e-06, 1.12181123e-05, 1.87650688e-05, 2.74495466e-05,
        3.51393989e-05, 3.93477910e-05, 3.85485708e-05, 3.30426846e-05,
        2.47737656e-05, 1.62554907e-05, 9.32707682e-06, 4.68483855e-06,
        2.05716379e-06, 7.90968089e-07, 2.65804286e-07, 7.82335584e-08,
        2.01198562e-08, 4.53311769e-09, 8.92190421e-10, 1.53875931e-10,
        2.31771498e-11, 3.05994894e-12]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a8b92f2c-4577-4930-973e-536a8e653603' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a8b92f2c-4577-4930-973e-536a8e653603' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dso_hires</span><span class="o">.</span><span class="n">trait_spc_active</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x2afadf9f8310&gt;
</pre></div>
</div>
<img alt="_images/trait-space-joint-pdf_26_1.png" src="_images/trait-space-joint-pdf_26_1.png" />
</div>
</div>
</section>
</section>
<section id="solve-for-maximum-metabolic-temperature">
<h2>Solve for maximum metabolic temperature<a class="headerlink" href="#solve-for-maximum-metabolic-temperature" title="Permalink to this headline">#</a></h2>
<p>Use root finding technique to solve for <span class="math notranslate nohighlight">\(AT_{max}\)</span> (the maximum temerature at which metabolism can be sustained) over all traits.</p>
<p>First illustrate computation on a subset of traits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mi</span><span class="o">.</span><span class="n">dEodT_bar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.022
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">PO2_atm</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">XiO2</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">kPa_per_atm</span>

<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>


<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">Ac</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">Eo</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mi">1</span><span class="p">]):</span>

        <span class="n">dEodT</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">dEodT_bar</span> <span class="k">if</span> <span class="n">Eo</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">ATmax_ij</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">compute_ATmax</span><span class="p">(</span><span class="n">PO2_atm</span><span class="p">,</span> <span class="n">Ac</span><span class="p">,</span> <span class="n">Eo</span><span class="p">,</span> <span class="n">dEodT</span><span class="o">=</span><span class="n">dEodT</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">mi</span><span class="o">.</span><span class="n">pO2_at_Phi_one</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Ac</span><span class="p">,</span> <span class="n">Eo</span><span class="p">,</span> <span class="n">dEodT</span><span class="o">=</span><span class="n">dEodT</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ATmax_ij</span><span class="p">,</span> <span class="n">PO2_atm</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">PO2_atm</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Eo=</span><span class="si">{</span><span class="n">Eo</span><span class="si">}</span><span class="s1">, Ac=</span><span class="si">{</span><span class="n">Ac</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/trait-space-joint-pdf_29_0.png" src="_images/trait-space-joint-pdf_29_0.png" />
</div>
</div>
<p>Now compute ATmax over entire trait-space domain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PO2_atm</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">XiO2</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">kPa_per_atm</span>


<span class="k">def</span> <span class="nf">solve_ATmax_over_trait_space</span><span class="p">(</span><span class="n">trait_space</span><span class="p">):</span>

    <span class="n">dEodT</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">dEodT_bar</span>

    <span class="n">metabolic_baseline</span> <span class="o">=</span> <span class="n">trait_space</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;metabolic_baseline&#39;</span><span class="p">]</span>
    <span class="n">hypoxic_tol</span><span class="p">,</span> <span class="n">temp_sens</span> <span class="o">=</span> <span class="n">trait_space</span><span class="o">.</span><span class="n">dims</span>

    <span class="n">ATmax</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">trait_space</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">ATmax</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ATmax_</span><span class="si">{</span><span class="n">metabolic_baseline</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">ATmax</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;AT$_</span><span class="si">{max}</span><span class="s1">$&#39;</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39; (</span><span class="si">{</span><span class="n">metabolic_baseline</span><span class="si">}</span><span class="s1">)&#39;</span>
    <span class="n">ATmax</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;°C&#39;</span>
    <span class="n">ATmax</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;note&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;computed using dEodT = </span><span class="si">{</span><span class="n">dEodT</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">A_parm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trait_space</span><span class="p">[</span><span class="n">hypoxic_tol</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">Eo</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trait_space</span><span class="p">[</span><span class="n">temp_sens</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>

            <span class="n">ATmax_ij</span> <span class="o">=</span> <span class="n">mi</span><span class="o">.</span><span class="n">compute_ATmax</span><span class="p">(</span><span class="n">PO2_atm</span><span class="p">,</span> <span class="n">Ac</span><span class="o">=</span><span class="n">A_parm</span><span class="p">,</span> <span class="n">Eo</span><span class="o">=</span><span class="n">Eo</span><span class="p">,</span> <span class="n">dEodT</span><span class="o">=</span><span class="n">dEodT</span><span class="p">)</span>
            <span class="n">ATmax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ATmax_ij</span>

    <span class="k">return</span> <span class="n">ATmax</span>


<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;trait_spc_active&#39;</span><span class="p">,</span> <span class="s1">&#39;trait_spc_resting&#39;</span><span class="p">]:</span>
    <span class="n">ATmax</span> <span class="o">=</span> <span class="n">solve_ATmax_over_trait_space</span><span class="p">(</span><span class="n">dso</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
    <span class="n">dso</span><span class="p">[</span><span class="n">ATmax</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ATmax</span>

    <span class="n">ATmax</span> <span class="o">=</span> <span class="n">solve_ATmax_over_trait_space</span><span class="p">(</span><span class="n">dso_hires</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
    <span class="n">dso_hires</span><span class="p">[</span><span class="n">ATmax</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ATmax</span>

<span class="n">dso</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:            (Ao: 12, Ac: 12, Eo: 11)
Coordinates:
  * Ao                 (Ao) float64 0.06811 0.08867 0.1147 ... 0.784 0.9872
  * Ac                 (Ac) float64 0.03 0.037 0.0456 ... 0.1974 0.2433 0.3
  * Eo                 (Eo) float64 -0.5 -0.3056 -0.1111 ... 0.8611 1.056 1.25
Data variables:
    Ao_cdf             (Ao) float64 0.01258 0.05662 0.1439 ... 0.9634 0.9818
    Ac_cdf             (Ac) float64 0.01258 0.05662 0.1439 ... 0.9634 0.9818
    Eo_cdf             (Eo) float64 0.0009272 0.007643 0.0411 ... 0.9915 0.9989
    Ao_pdf             (Ao) float64 1.361 2.824 3.714 ... 0.2847 0.1348 0.05895
    Ac_pdf             (Ac) float64 3.927 8.428 11.39 ... 0.996 0.4794 0.2129
    Eo_pdf             (Eo) float64 0.0111 0.07442 0.3113 ... 0.08196 0.01257
    trait_spc_active   (Ac, Eo) float64 0.0001004 0.0006727 ... 6.159e-06
    trait_spc_resting  (Ao, Eo) float64 0.0001098 0.0007361 ... 5.384e-06
    ATmax_active       (Ac, Eo) float64 nan nan nan nan ... 27.2 25.63 24.37
    ATmax_resting      (Ao, Eo) float64 42.49 35.22 29.01 ... 33.29 31.24 29.54</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-577f9e8a-5e4d-491f-832a-0e93ba31524c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-577f9e8a-5e4d-491f-832a-0e93ba31524c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>Ao</span>: 12</li><li><span class='xr-has-index'>Ac</span>: 12</li><li><span class='xr-has-index'>Eo</span>: 11</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-3df6eb6f-daf6-4fd0-84c4-5143773ba8ce' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3df6eb6f-daf6-4fd0-84c4-5143773ba8ce' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Ao</span></div><div class='xr-var-dims'>(Ao)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.06811 0.08867 ... 0.784 0.9872</div><input id='attrs-209ed1b2-fbaa-4fc7-9542-818982c916da' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-209ed1b2-fbaa-4fc7-9542-818982c916da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-13c9cc47-5cd6-4316-a27d-ed324daeb608' class='xr-var-data-in' type='checkbox'><label for='data-13c9cc47-5cd6-4316-a27d-ed324daeb608' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Hypoxic tolerance</dd><dt><span>units :</span></dt><dd>1/kPa</dd></dl></div><div class='xr-var-data'><pre>array([0.068106, 0.088674, 0.114712, 0.147614, 0.189177, 0.241291, 0.306919,
       0.389502, 0.492625, 0.62211 , 0.784033, 0.987234])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Ac</span></div><div class='xr-var-dims'>(Ac)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.03 0.037 0.0456 ... 0.2433 0.3</div><input id='attrs-e670ebab-1361-460b-9a8c-faa0c64831a3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e670ebab-1361-460b-9a8c-faa0c64831a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-92f5c0cf-5377-42b2-84c9-bf81f30f6d7f' class='xr-var-data-in' type='checkbox'><label for='data-92f5c0cf-5377-42b2-84c9-bf81f30f6d7f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Hypoxic tolerance (normalized by $\Phi_{crit}$)</dd><dt><span>units :</span></dt><dd>1/kPa</dd></dl></div><div class='xr-var-data'><pre>array([0.03  , 0.037 , 0.0456, 0.0562, 0.0693, 0.0854, 0.1053, 0.1299, 0.1601,
       0.1974, 0.2433, 0.3   ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Eo</span></div><div class='xr-var-dims'>(Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.5 -0.3056 -0.1111 ... 1.056 1.25</div><input id='attrs-7fab065f-5094-4724-9264-03bc73e49554' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7fab065f-5094-4724-9264-03bc73e49554' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae6e5eee-621c-4282-b0b5-6b3276ccadd4' class='xr-var-data-in' type='checkbox'><label for='data-ae6e5eee-621c-4282-b0b5-6b3276ccadd4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Temperature sensitivity</dd><dt><span>units :</span></dt><dd>eV</dd></dl></div><div class='xr-var-data'><pre>array([-0.5     , -0.3056  , -0.1111  ,  0.0833  ,  0.2778  ,  0.380678,
        0.4722  ,  0.6667  ,  0.8611  ,  1.0556  ,  1.25    ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-88e515b7-8a82-42fc-ab7f-c34460244042' class='xr-section-summary-in' type='checkbox'  checked><label for='section-88e515b7-8a82-42fc-ab7f-c34460244042' class='xr-section-summary' >Data variables: <span>(10)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Ao_cdf</span></div><div class='xr-var-dims'>(Ao)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.01258 0.05662 ... 0.9634 0.9818</div><input id='attrs-c37ecd2d-803f-4e91-ada8-3e0a4a306bf2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c37ecd2d-803f-4e91-ada8-3e0a4a306bf2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-17a1b3fe-aaa2-43bb-9ab3-cac744e466cb' class='xr-var-data-in' type='checkbox'><label for='data-17a1b3fe-aaa2-43bb-9ab3-cac744e466cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.01257777, 0.05662097, 0.14394613, 0.26940383, 0.4163934 ,
       0.56375229, 0.6954788 , 0.80159361, 0.87899004, 0.93112507,
       0.96335562, 0.98182818])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Ac_cdf</span></div><div class='xr-var-dims'>(Ac)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.01258 0.05662 ... 0.9634 0.9818</div><input id='attrs-e87ea904-1cce-4158-a96f-dfd681851af0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e87ea904-1cce-4158-a96f-dfd681851af0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b5bc3c93-b364-4d5d-9a56-e234d6fddcb3' class='xr-var-data-in' type='checkbox'><label for='data-b5bc3c93-b364-4d5d-9a56-e234d6fddcb3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.01257777, 0.05662097, 0.14394613, 0.26940383, 0.4163934 ,
       0.56375229, 0.6954788 , 0.80159361, 0.87899004, 0.93112507,
       0.96335562, 0.98182818])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Eo_cdf</span></div><div class='xr-var-dims'>(Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0009272 0.007643 ... 0.9989</div><input id='attrs-cb3164fc-0bb0-4a35-a4d5-1ed419cfb25c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cb3164fc-0bb0-4a35-a4d5-1ed419cfb25c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-35bf497a-3876-490c-b357-a13f938bcb92' class='xr-var-data-in' type='checkbox'><label for='data-35bf497a-3876-490c-b357-a13f938bcb92' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([9.27227238e-04, 7.64303444e-03, 4.10963306e-02, 1.46622432e-01,
       3.58077128e-01, 5.00000000e-01, 6.26830276e-01, 8.43966994e-01,
       9.55243246e-01, 9.91469630e-01, 9.98938522e-01])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Ao_pdf</span></div><div class='xr-var-dims'>(Ao)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.361 2.824 ... 0.1348 0.05895</div><input id='attrs-871c6efe-e9b5-4c6d-a338-885cd98a4f24' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-871c6efe-e9b5-4c6d-a338-885cd98a4f24' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-61d186fa-cbfa-42da-adb7-a5116efa20e6' class='xr-var-data-in' type='checkbox'><label for='data-61d186fa-cbfa-42da-adb7-a5116efa20e6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1.36125156, 2.82392897, 3.71350972, 3.78237708, 3.23842168,
       2.43041355, 1.63265246, 0.99409667, 0.55505541, 0.28466603,
       0.13484826, 0.05894828])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Ac_pdf</span></div><div class='xr-var-dims'>(Ac)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.927 8.428 11.39 ... 0.4794 0.2129</div><input id='attrs-5e5f0461-454a-4dda-a20f-67904b9db288' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5e5f0461-454a-4dda-a20f-67904b9db288' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-96725caf-ddb5-4f7f-9a1d-fb78d943fd37' class='xr-var-data-in' type='checkbox'><label for='data-96725caf-ddb5-4f7f-9a1d-fb78d943fd37' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 3.92680296,  8.42757271, 11.38573265, 11.86938536, 10.37716577,
        7.93944485,  5.43129161,  3.36510266,  1.91059171,  0.99595784,
        0.47935406,  0.21285338])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Eo_pdf</span></div><div class='xr-var-dims'>(Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0111 0.07442 ... 0.08196 0.01257</div><input id='attrs-e36f3f7d-b5fe-46a8-aba5-0bd8bfe51a91' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e36f3f7d-b5fe-46a8-aba5-0bd8bfe51a91' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4cc33192-927f-45fd-87b6-b7f1d49bc527' class='xr-var-data-in' type='checkbox'><label for='data-4cc33192-927f-45fd-87b6-b7f1d49bc527' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.01110274, 0.07442134, 0.31132536, 0.81160007, 1.31980058,
       1.40999242, 1.3381231 , 0.84588535, 0.33354884, 0.08196417,
       0.01256991])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>trait_spc_active</span></div><div class='xr-var-dims'>(Ac, Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0001004 0.0006727 ... 6.159e-06</div><input id='attrs-62d0a04a-14cf-4ab1-84db-68c5f29a4339' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-62d0a04a-14cf-4ab1-84db-68c5f29a4339' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1052a37a-72d8-4995-9aa2-5600c4171ee7' class='xr-var-data-in' type='checkbox'><label for='data-1052a37a-72d8-4995-9aa2-5600c4171ee7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Trait density (active)</dd><dt><span>units :</span></dt><dd>eV 1/kPa</dd><dt><span>metabolic_baseline :</span></dt><dd>active</dd><dt><span>N_traits :</span></dt><dd>132</dd></dl></div><div class='xr-var-data'><pre>array([[1.00358230e-04, 6.72698399e-04, 2.81408643e-03, 7.33609608e-03,
        1.19297474e-02, 1.27449962e-02, 1.20953656e-02, 7.64600251e-03,
        3.01496564e-03, 7.40878515e-04, 1.13620084e-04],
       [2.15385464e-04, 1.44372273e-03, 6.03949784e-03, 1.57444832e-02,
        2.56032234e-02, 2.73528831e-02, 2.59586678e-02, 1.64095940e-02,
        6.47061807e-03, 1.59004860e-03, 2.43847612e-04],
       [2.90987855e-04, 1.95048344e-03, 8.15942028e-03, 2.12709498e-02,
        3.45902036e-02, 3.69540110e-02, 3.50704125e-02, 2.21695209e-02,
        8.74186790e-03, 2.14817112e-03, 3.29440494e-04],
       [3.03348682e-04, 2.03333771e-03, 8.50602299e-03, 2.21745151e-02,
        3.60595553e-02, 3.85237745e-02, 3.65601629e-02, 2.31112565e-02,
        9.11321231e-03, 2.23942293e-03, 3.43434744e-04],
       [2.65211673e-04, 1.77770641e-03, 7.43664545e-03, 1.93867342e-02,
        3.15261466e-02, 3.36805640e-02, 3.19638178e-02, 2.02057084e-02,
        7.96749890e-03, 1.95788259e-03, 3.00258114e-04],
       [2.02910265e-04, 1.36010182e-03, 5.68968808e-03, 1.48325574e-02,
        2.41202760e-02, 2.57685949e-02, 2.44551330e-02, 1.54591447e-02,
        6.09583768e-03, 1.49795245e-03, 2.29723876e-04],
       [1.38808801e-04, 9.30431502e-04, 3.89225641e-03, 1.01467982e-02,
        1.65004298e-02, 1.76280276e-02, 1.67295020e-02, 1.05754401e-02,
        4.17009913e-03, 1.02473368e-03, 1.57151713e-04],
       [8.60027226e-05, 5.76473839e-04, 2.41155205e-03, 6.28672147e-03,
        1.02232847e-02, 1.09219182e-02, 1.03652125e-02, 6.55229806e-03,
        2.58369697e-03, 6.34901290e-04, 9.73675666e-05],
       [4.88294430e-05, 3.27302387e-04, 1.36919786e-03, 3.56938825e-03,
        5.80443598e-03, 6.20109650e-03, 5.88501779e-03, 3.72017367e-03,
        1.46693593e-03, 3.60475522e-04, 5.52820178e-05],
       [2.54539295e-05, 1.70616976e-04, 7.13738753e-04, 1.86065930e-03,
        3.02575035e-03, 3.23252251e-03, 3.06775624e-03, 1.93926109e-03,
        7.64687892e-04, 1.87909548e-04, 2.88175433e-05],
       [1.22509648e-05, 8.21178736e-05, 3.43522140e-04, 8.95534480e-04,
        1.45629228e-03, 1.55581163e-03, 1.47650969e-03, 9.33365485e-04,
        3.68043938e-04, 9.04407805e-05, 1.38698706e-05],
       [5.43994403e-06, 3.64637924e-05, 1.52538289e-04, 3.97655003e-04,
        6.46655070e-04, 6.90845848e-04, 6.55632452e-04, 4.14453562e-04,
        1.63427000e-04, 4.01595133e-05, 6.15880634e-06]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>trait_spc_resting</span></div><div class='xr-var-dims'>(Ao, Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0001098 0.0007361 ... 5.384e-06</div><input id='attrs-f3199d8b-05ae-4d89-8deb-64d3ac03836a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f3199d8b-05ae-4d89-8deb-64d3ac03836a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-628a802e-fe2a-4b67-8cdc-94181c06051a' class='xr-var-data-in' type='checkbox'><label for='data-628a802e-fe2a-4b67-8cdc-94181c06051a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Trait density (resting)</dd><dt><span>units :</span></dt><dd>eV 1/kPa</dd><dt><span>metabolic_baseline :</span></dt><dd>resting</dd><dt><span>N_traits :</span></dt><dd>132</dd></dl></div><div class='xr-var-data'><pre>array([[1.09818486e-04, 7.36110232e-04, 3.07935594e-03, 8.02763229e-03,
        1.30543035e-02, 1.39464018e-02, 1.32355338e-02, 8.36675201e-03,
        3.29917101e-03, 8.10717338e-04, 1.24330468e-04],
       [2.27819466e-04, 1.52706750e-03, 6.38815243e-03, 1.66533975e-02,
        2.70812736e-02, 2.89319396e-02, 2.74572375e-02, 1.73569046e-02,
        6.84416083e-03, 1.68184063e-03, 2.57924708e-04],
       [2.99586077e-04, 2.00811708e-03, 8.40051800e-03, 2.18994721e-02,
        3.56122884e-02, 3.80459425e-02, 3.61066867e-02, 2.28245946e-02,
        9.00017601e-03, 2.21164611e-03, 3.39174929e-04],
       [3.05141927e-04, 2.04535778e-03, 8.55630634e-03, 2.23055997e-02,
        3.62727214e-02, 3.87515078e-02, 3.67762883e-02, 2.32478787e-02,
        9.16708506e-03, 2.25266128e-03, 3.45464958e-04],
       [2.61258518e-04, 1.75120853e-03, 7.32579734e-03, 1.90977621e-02,
        3.10562286e-02, 3.31785330e-02, 3.14873760e-02, 1.99045290e-02,
        7.84873807e-03, 1.92869906e-03, 2.95782569e-04],
       [1.96072750e-04, 1.31427014e-03, 5.49796131e-03, 1.43327412e-02,
        2.33074893e-02, 2.49002644e-02, 2.36310625e-02, 1.49382143e-02,
        5.89042479e-03, 1.44747559e-03, 2.21982816e-04],
       [1.31713657e-04, 8.82872952e-04, 3.69330564e-03, 9.62814957e-03,
        1.56570185e-02, 1.67269797e-02, 1.58743817e-02, 1.00348816e-02,
        3.95694656e-03, 9.72354925e-04, 1.49118980e-04],
       [8.01983957e-05, 5.37567598e-04, 2.24879632e-03, 5.86243041e-03,
        9.53331485e-03, 1.01847976e-02, 9.66566394e-03, 6.11008323e-03,
        2.40932317e-03, 5.92051779e-04, 9.07962261e-05],
       [4.47788981e-05, 3.00151699e-04, 1.25561890e-03, 3.27329707e-03,
        5.32294107e-03, 5.68669745e-03, 5.39683839e-03, 3.41157441e-03,
        1.34524931e-03, 3.30573025e-04, 5.06962131e-05],
       [2.29653307e-05, 1.53935968e-04, 6.43957410e-04, 1.67874497e-03,
        2.72992653e-03, 2.91648283e-03, 2.76782556e-03, 1.74966196e-03,
        6.89925315e-04, 1.69537867e-04, 2.60000882e-05],
       [1.08788352e-05, 7.29205276e-05, 3.05047057e-04, 7.95233045e-04,
        1.29318499e-03, 1.38155799e-03, 1.31113801e-03, 8.28826912e-04,
        3.26822370e-04, 8.03112542e-05, 1.23164207e-05],
       [4.75563148e-06, 3.18768645e-05, 1.33349881e-04, 3.47632373e-04,
        5.65309715e-04, 6.03941556e-04, 5.73157796e-04, 3.62317773e-04,
        1.42868857e-04, 3.51076858e-05, 5.38406520e-06]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ATmax_active</span></div><div class='xr-var-dims'>(Ac, Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan ... 27.2 25.63 24.37</div><input id='attrs-7717dd26-ae6d-4f39-97b7-461d268f0b59' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7717dd26-ae6d-4f39-97b7-461d268f0b59' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ad285eb8-a361-41ad-8c39-d6e5bbcf7074' class='xr-var-data-in' type='checkbox'><label for='data-ad285eb8-a361-41ad-8c39-d6e5bbcf7074' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>AT$_{max}$ (active)</dd><dt><span>units :</span></dt><dd>°C</dd><dt><span>metabolic_baseline :</span></dt><dd>active</dd><dt><span>N_traits :</span></dt><dd>132</dd><dt><span>note :</span></dt><dd>computed using dEodT = 0.022</dd></dl></div><div class='xr-var-data'><pre>array([[        nan,         nan,         nan,         nan,         nan,
                nan,         nan,  9.12730859, 10.87727821, 11.76344084,
        12.31974507],
       [33.13144063,         nan,         nan,         nan,         nan,
                nan, 10.43406143, 12.17508882, 12.89889692, 13.31661478,
        13.59208319],
       [37.21510092, 28.04443692,         nan,         nan, 14.10220815,
        14.36775311, 14.49690703, 14.64775217, 14.72848583, 14.77899364,
        14.8135903 ],
       [40.19896232, 32.3843264 , 25.63454284, 20.9839242 , 18.57820288,
        17.86770947, 17.41838582, 16.79539619, 16.41906669, 16.17000352,
        15.99412817],
       [42.68701153, 35.45152062, 29.26641961, 24.64192982, 21.64921391,
        20.58066032, 19.84251597, 18.72880537, 18.00367128, 17.50313858,
        17.14069972],
       [44.86308173, 37.96781837, 32.04687545, 27.4244986 , 24.14853192,
        22.87754236, 21.95774202, 20.49622947, 19.49405076, 18.77926325,
        18.25067852],
       [46.83432444, 40.1695502 , 34.40794206, 29.78166999, 26.32718758,
        24.9201182 , 23.871332  , 22.14432376, 20.91354853, 20.01217287,
        19.33348962],
       [48.65264129, 42.15646148, 36.50292892, 31.87055162, 28.28900512,
        26.78184995, 25.63500684, 23.69611134, 22.27223403, 21.2063281 ,
        20.39112313],
       [50.34063127, 43.97337857, 38.39802047, 33.75865933, 30.08047353,
        28.49581585, 27.27137665, 25.15890003, 23.56985669, 22.35823039,
        21.41886987],
       [51.9327474 , 45.66836617, 40.15266211, 35.50593205, 31.75011664,
        30.10257747, 28.81422886, 26.55506396, 24.82164667, 23.47891731,
        22.42527661],
       [53.43982934, 47.25943178, 41.79060964, 37.13640279, 33.31630473,
        31.61642253, 30.27429834, 27.88924431, 26.02851283, 24.56733218,
        23.408363  ],
       [54.88009145, 48.76995014, 43.33903731, 38.67734409, 34.80243411,
        33.05782214, 31.66937797, 29.17419448, 27.1995825 , 25.63023548,
        24.37338399]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ATmax_resting</span></div><div class='xr-var-dims'>(Ao, Eo)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>42.49 35.22 29.01 ... 31.24 29.54</div><input id='attrs-b5da911d-58b6-4eaa-b094-eb41f427a683' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b5da911d-58b6-4eaa-b094-eb41f427a683' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d908aa20-8d12-4b93-94f1-b40cc7ea3729' class='xr-var-data-in' type='checkbox'><label for='data-d908aa20-8d12-4b93-94f1-b40cc7ea3729' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>AT$_{max}$ (resting)</dd><dt><span>units :</span></dt><dd>°C</dd><dt><span>metabolic_baseline :</span></dt><dd>resting</dd><dt><span>N_traits :</span></dt><dd>132</dd><dt><span>note :</span></dt><dd>computed using dEodT = 0.022</dd></dl></div><div class='xr-var-data'><pre>array([[42.49409759, 35.22248808, 29.00694811, 24.38171   , 21.42103048,
        20.37421517, 19.65480909, 18.57523357, 17.87593619, 17.39472488,
        17.04694303],
       [45.23078402, 38.38314368, 32.49629596, 27.87349014, 24.55997973,
        23.26086752, 22.31484388, 20.80059341, 19.7541912 , 19.00399989,
        18.44732194],
       [47.59254567, 41.00240304, 35.28947409, 30.66087839, 27.14992994,
        25.69867352, 24.60691091, 22.78808544, 21.47479106, 20.50387923,
        19.76797258],
       [49.69776107, 43.28408573, 37.68101706, 33.04443318, 29.40107125,
        27.84445625, 26.64825059, 24.59951908, 23.07185272, 21.91491163,
        21.02249891],
       [51.61643432, 45.33286765, 39.80622229, 35.16100485, 31.41973865,
        29.78401728, 28.50773999, 26.27653051, 24.57096113, 23.25378805,
        22.22261469],
       [53.38145288, 47.19801394, 41.72752328, 37.07361346, 33.25586383,
        31.5578967 , 30.21774849, 27.83735839, 25.9813987 , 24.52470508,
        23.36976145],
       [55.03306806, 48.92988376, 43.50265717, 38.8401526 , 34.95974787,
        33.21065017, 31.81754391, 29.3111931 , 27.32490611, 25.74435348,
        24.47727   ],
       [56.59160897, 50.55440985, 45.16150774, 40.49058957, 36.55731328,
        34.7650668 , 33.3269735 , 30.71212361, 28.61121685, 26.91952212,
        25.55003106],
       [58.06318095, 52.08100391, 46.71578561, 42.03671621, 38.05807314,
        36.22886259, 34.75204794, 32.04279306, 29.84045345, 28.04872201,
        26.58564135],
       [59.46975573, 53.53452369, 48.19218239, 43.50517435, 39.48663212,
        37.62500015, 36.11410713, 33.32105021, 31.02740111, 29.14430341,
        27.59459624],
       [60.81579159, 54.92100116, 49.5977591 , 44.90304654, 40.84903027,
        38.95867102, 37.41750884, 34.54950052, 32.1732204 , 30.20639785,
        28.57636561],
       [62.11406581, 56.25463481, 50.94757734, 46.24535334, 42.15929797,
        40.24309394, 38.67465297, 35.73871718, 33.28679939, 31.24249501,
        29.53733979]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-42275043-9519-4826-a126-047911bbb244' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-42275043-9519-4826-a126-047911bbb244' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dso</span><span class="o">.</span><span class="n">ATmax_active</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/trait-space-joint-pdf_32_0.png" src="_images/trait-space-joint-pdf_32_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dso</span><span class="o">.</span><span class="n">ATmax_resting</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/trait-space-joint-pdf_33_0.png" src="_images/trait-space-joint-pdf_33_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dso_hires</span><span class="o">.</span><span class="n">ATmax_resting</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x2afadff50090&gt;
</pre></div>
</div>
<img alt="_images/trait-space-joint-pdf_34_1.png" src="_images/trait-space-joint-pdf_34_1.png" />
</div>
</div>
</section>
<section id="write-out-cached-trait-space-data">
<h2>Write out cached trait-space data<a class="headerlink" href="#write-out-cached-trait-space-data" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clobber</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">this_notebook</span> <span class="o">=</span> <span class="s1">&#39;trait-space-joint-pdf.ipynb&#39;</span>

<span class="n">curator</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">curator_local_assets</span><span class="p">()</span>

<span class="k">if</span> <span class="n">clobber</span><span class="p">:</span>
    <span class="n">cache_file</span> <span class="o">=</span> <span class="s1">&#39;data/cache/trait-space.zarr&#39;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">cache_file</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dso</span><span class="o">.</span><span class="n">to_zarr</span><span class="p">(</span><span class="n">cache_file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">consolidated</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">curator</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span>
        <span class="n">key</span><span class="o">=</span><span class="s1">&#39;trait-space&#39;</span><span class="p">,</span>
        <span class="n">urlpath</span><span class="o">=</span><span class="n">cache_file</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Idealized trait space generated by </span><span class="si">{</span><span class="n">this_notebook</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;zarr&#39;</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cache_file</span> <span class="o">=</span> <span class="s1">&#39;data/cache/trait-space-hires.zarr&#39;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">cache_file</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dso_hires</span><span class="o">.</span><span class="n">to_zarr</span><span class="p">(</span><span class="n">cache_file</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">consolidated</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">curator</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span>
        <span class="n">key</span><span class="o">=</span><span class="s1">&#39;trait-space-hires&#39;</span><span class="p">,</span>
        <span class="n">urlpath</span><span class="o">=</span><span class="n">cache_file</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Idealized trait space generated by </span><span class="si">{</span><span class="n">this_notebook</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;zarr&#39;</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">cat</span> <span class="o">=</span> <span class="n">curator</span><span class="o">.</span><span class="n">open_catalog</span><span class="p">()</span>
<span class="n">ds_cache</span> <span class="o">=</span> <span class="n">cat</span><span class="p">[</span><span class="s1">&#39;trait-space&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dask</span><span class="p">()</span>
<span class="n">xr</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_identical</span><span class="p">(</span><span class="n">dso</span><span class="p">,</span> <span class="n">ds_cache</span><span class="p">)</span>

<span class="n">cat</span> <span class="o">=</span> <span class="n">curator</span><span class="o">.</span><span class="n">open_catalog</span><span class="p">()</span>
<span class="n">ds_cache</span> <span class="o">=</span> <span class="n">cat</span><span class="p">[</span><span class="s1">&#39;trait-space-hires&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dask</span><span class="p">()</span>
<span class="n">xr</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_identical</span><span class="p">(</span><span class="n">dso_hires</span><span class="p">,</span> <span class="n">ds_cache</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>overwriting &quot;trait-space&quot; key in &quot;sources&quot;
overwriting &quot;trait-space-hires&quot; key in &quot;sources&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dso</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>xarray.Dataset {
dimensions:
	Ao = 12 ;
	Ac = 12 ;
	Eo = 11 ;

variables:
	float64 Ao(Ao) ;
		Ao:long_name = Hypoxic tolerance ;
		Ao:units = 1/kPa ;
	float64 Ac(Ac) ;
		Ac:long_name = Hypoxic tolerance (normalized by $\Phi_{crit}$) ;
		Ac:units = 1/kPa ;
	float64 Eo(Eo) ;
		Eo:long_name = Temperature sensitivity ;
		Eo:units = eV ;
	float64 Ao_cdf(Ao) ;
	float64 Ac_cdf(Ac) ;
	float64 Eo_cdf(Eo) ;
	float64 Ao_pdf(Ao) ;
	float64 Ac_pdf(Ac) ;
	float64 Eo_pdf(Eo) ;
	float64 trait_spc_active(Ac, Eo) ;
		trait_spc_active:long_name = Trait density (active) ;
		trait_spc_active:units = eV 1/kPa ;
		trait_spc_active:metabolic_baseline = active ;
		trait_spc_active:N_traits = 132 ;
	float64 trait_spc_resting(Ao, Eo) ;
		trait_spc_resting:long_name = Trait density (resting) ;
		trait_spc_resting:units = eV 1/kPa ;
		trait_spc_resting:metabolic_baseline = resting ;
		trait_spc_resting:N_traits = 132 ;
	float64 ATmax_active(Ac, Eo) ;
		ATmax_active:long_name = AT$_{max}$ (active) ;
		ATmax_active:units = °C ;
		ATmax_active:metabolic_baseline = active ;
		ATmax_active:N_traits = 132 ;
		ATmax_active:note = computed using dEodT = 0.022 ;
	float64 ATmax_resting(Ao, Eo) ;
		ATmax_resting:long_name = AT$_{max}$ (resting) ;
		ATmax_resting:units = °C ;
		ATmax_resting:metabolic_baseline = resting ;
		ATmax_resting:N_traits = 132 ;
		ATmax_resting:note = computed using dEodT = 0.022 ;

// global attributes:
}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dso_hires</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>xarray.Dataset {
dimensions:
	Ao = 30 ;
	Ac = 30 ;
	Eo = 30 ;

variables:
	float64 Ao(Ao) ;
		Ao:long_name = Hypoxic tolerance ;
		Ao:units = 1/kPa ;
	float64 Ac(Ac) ;
		Ac:long_name = Hypoxic tolerance (normalized by $\Phi_{crit}$) ;
		Ac:units = 1/kPa ;
	float64 Eo(Eo) ;
		Eo:long_name = Temperature sensitivity ;
		Eo:units = eV ;
	float64 Ao_cdf(Ao) ;
	float64 Ac_cdf(Ac) ;
	float64 Eo_cdf(Eo) ;
	float64 Ao_pdf(Ao) ;
	float64 Ac_pdf(Ac) ;
	float64 Eo_pdf(Eo) ;
	float64 trait_spc_active(Ac, Eo) ;
		trait_spc_active:long_name = Trait density (active) ;
		trait_spc_active:units = eV 1/kPa ;
		trait_spc_active:metabolic_baseline = active ;
		trait_spc_active:N_traits = 900 ;
	float64 trait_spc_resting(Ao, Eo) ;
		trait_spc_resting:long_name = Trait density (resting) ;
		trait_spc_resting:units = eV 1/kPa ;
		trait_spc_resting:metabolic_baseline = resting ;
		trait_spc_resting:N_traits = 900 ;
	float64 ATmax_active(Ac, Eo) ;
		ATmax_active:long_name = AT$_{max}$ (active) ;
		ATmax_active:units = °C ;
		ATmax_active:metabolic_baseline = active ;
		ATmax_active:N_traits = 900 ;
		ATmax_active:note = computed using dEodT = 0.022 ;
	float64 ATmax_resting(Ao, Eo) ;
		ATmax_resting:long_name = AT$_{max}$ (resting) ;
		ATmax_resting:units = °C ;
		ATmax_resting:metabolic_baseline = resting ;
		ATmax_resting:N_traits = 900 ;
		ATmax_resting:note = computed using dEodT = 0.022 ;

// global attributes:
}
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-env-miniconda3-metabolic-py"
        },
        kernelOptions: {
            kernelName: "conda-env-miniconda3-metabolic-py",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-env-miniconda3-metabolic-py'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="metabolic-index-defining.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">The Metabolic Index</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="trait-space-obs-habitat-vol.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Defining the Aerobic Safety Margin</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Matthew C. Long, Curtis Deutsch, Precious Mongwe, Takamitsu Ito<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>